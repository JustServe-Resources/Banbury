import{j as e,F as t,L as n,S as a,H as r,I as i,M as s,s as l,T as o,u as d,r as c,a as u,b as h,c as p,C as m,O as f,d as g,e as x,f as j,p as v,g as b,h as y,i as w,P as C,A as _,k as q,N as k,l as S,m as F,n as R,o as P,q as T,D as I,t as E,v as D,w as L,x as $,y as G,z as V,B as M,$ as A,E as X,G as z,J as H,K as U,Q as B,R as O,U as N,V as W}from"shared";function K({field:l,onChange:o}){const{label:d,error:c,value:u,name:h,required:p,description:m,type:f}=l,g={},x="integer"===f||"decimal"===f?"number":"text";"integer"===f&&(g.step="1"),"decimal"===f&&(g.step="any");const j="anonymous_requester_email"===f?"email":void 0;return e.jsxs(t,{children:[e.jsxs(n,{children:[d,p&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),m&&e.jsx(r,{dangerouslySetInnerHTML:{__html:m}}),e.jsx(i,{name:h,type:x,defaultValue:u,validation:c?"error":void 0,required:p,onChange:e=>{o&&o(e.target.value)},autoComplete:j,...g}),c&&e.jsx(s,{validation:"error",children:c})]})}const J=l(t)`
  .ck.ck-editor {
    margin-top: ${e=>e.theme.space.xs};
  }
`,Z=l(s)`
  .ck.ck-editor + & {
    margin-top: ${e=>e.theme.space.xs};
  }
`;function Q({field:t,onChange:i}){const{label:s,error:l,value:d,name:c,required:u,description:h}=t;return e.jsxs(J,{children:[e.jsxs(n,{children:[s,u&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),h&&e.jsx(r,{dangerouslySetInnerHTML:{__html:h}}),e.jsx(o,{name:c,defaultValue:d,validation:l?"error":void 0,required:u,onChange:e=>i(e.target.value),rows:6,isResizable:!0}),l&&e.jsx(Z,{validation:"error",children:l})]})}function Y(){const{t:t}=d();return e.jsxs(e.Fragment,{children:[e.jsx(a,{"aria-hidden":"true",children:"-"}),e.jsx(a,{hidden:!0,children:t("new-request-form.dropdown.empty-option","Select an option")})]})}function ee({field:t,onChange:n}){const{label:r,options:i,error:s,value:l,name:o,required:d,description:x}=t,j=null==l?"":l.toString(),v=c.useRef(null);return c.useEffect((()=>{if(v.current&&d){const e=v.current.querySelector("[role=combobox]");e?.setAttribute("aria-required","true")}}),[v,d]),e.jsxs(u,{children:[e.jsxs(h,{children:[r,d&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),x&&e.jsx(p,{dangerouslySetInnerHTML:{__html:x}}),e.jsxs(m,{ref:v,inputProps:{name:o,required:d},isEditable:!1,validation:s?"error":void 0,inputValue:j,selectionValue:j,renderValue:({selection:t})=>t?.label||e.jsx(Y,{}),onChange:({selectionValue:e})=>{void 0!==e&&n(e)},children:[!d&&e.jsx(f,{value:"",label:"-",children:e.jsx(Y,{})}),i.map((t=>e.jsx(f,{value:t.value.toString(),label:t.name},t.value)))]}),s&&e.jsx(g,{validation:"error",children:s})]})}function te({field:i,onChange:l}){const{label:o,error:d,value:u,name:h,required:p,description:m}=i,[f,g]=c.useState(u);return e.jsxs(t,{children:[e.jsx("input",{type:"hidden",name:h,value:"off"}),e.jsxs(x,{name:h,required:p,defaultChecked:u,value:f?"on":"off",onChange:e=>{const{checked:t}=e.target;g(t),l(t)},children:[e.jsxs(n,{children:[o,p&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),m&&e.jsx(r,{dangerouslySetInnerHTML:{__html:m}})]}),d&&e.jsx(s,{validation:"error",children:d})]})}const ne="[]";function ae(e){return`[${e.join("::")}]`}function re(e){return e.startsWith("[")&&e.endsWith("]")}function ie(e){const t=ae(e.slice(0,-1));return{type:"SubGroup",name:e[e.length-1],backOption:{type:"previous",label:"Back",value:t},options:[]}}function se({options:e,hasEmptyOption:t}){const n=c.useMemo((()=>function(e,t){const n={[ne]:{type:"RootGroup",options:t?[{label:"-",value:""}]:[]}};return e.forEach((e=>{const{name:t,value:a}=e;if(t.includes("::")){const[e,r]=function(e){const t=e.split("::");return[t.slice(0,-1),t.slice(-1)[0]]}(t),i=ae(e);n[i]||(n[i]=ie(e)),n[i]?.options.push({value:a,label:t.split("::").join(" > "),menuLabel:r});for(let t=0;t<e.length;t++){const a=e.slice(0,t),r=e.slice(0,t+1),i=ae(a),s=ae(r);n[i]||(n[i]=ie(a)),void 0===n[i]?.options.find((e=>e.value===s))&&n[i]?.options.push({type:"next",label:r[r.length-1],value:s})}}else n[ne].options.push({value:a,label:t})})),n}(e,t)),[e,t]),[a,r]=c.useState(function(e){const t={type:"RootGroup",options:[]};return Object.values(e).forEach((({options:e})=>{t.options.push(...e.filter((({type:e})=>void 0===e)))})),t}(n));c.useEffect((()=>{r(n[ne])}),[n]);return{currentGroup:a,isGroupIdentifier:re,setCurrentGroupByIdentifier:e=>{const t=n[e];t&&r(t)}}}function le({field:t}){const{label:n,options:r,error:i,value:s,name:l,required:o,description:d}=t,{currentGroup:x,isGroupIdentifier:v,setCurrentGroupByIdentifier:b}=se({options:r,hasEmptyOption:!1}),[y,w]=c.useState(s||[]),C=c.useRef(null);c.useEffect((()=>{if(C.current&&o){const e=C.current.querySelector("[role=combobox]");e?.setAttribute("aria-required","true")}}),[C,o]);return e.jsxs(u,{children:[y.map((t=>e.jsx("input",{type:"hidden",name:`${l}[]`,value:t},t))),e.jsxs(h,{children:[n,o&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),d&&e.jsx(p,{dangerouslySetInnerHTML:{__html:d}}),e.jsxs(m,{ref:C,isMultiselectable:!0,inputProps:{required:o},isEditable:!1,validation:i?"error":void 0,onChange:e=>{if(Array.isArray(e.selectionValue)){const t=e.selectionValue.slice(-1).toString();v(t)?b(t):w(e.selectionValue)}},selectionValue:y,maxHeight:"auto",children:["SubGroup"===x.type&&e.jsx(f,{...x.backOption}),"SubGroup"===x.type?e.jsx(j,{"aria-label":x.name,children:x.options.map((t=>e.jsx(f,{...t,children:t.menuLabel??t.label},t.value)))}):x.options.map((t=>e.jsx(f,{...t},t.value)))]}),i&&e.jsx(g,{validation:"error",children:i})]})}const oe="return-focus-to-ticket-form-field";function de({field:t,newRequestPath:n}){const a=c.createRef();return c.useEffect((()=>{sessionStorage.getItem(oe)&&(sessionStorage.removeItem(oe),a.current?.firstChild?.focus())}),[]),e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"hidden",name:t.name,value:t.value}),t.options.length>1&&e.jsxs(u,{children:[e.jsx(h,{children:t.label}),e.jsx(m,{isEditable:!1,onChange:({selectionValue:e})=>{if(e&&"number"==typeof e){const t=new URL(window.location.href);t.searchParams.set("ticket_form_id",e),sessionStorage.setItem(oe,"true"),window.location.assign(`${n}${t.search}`)}},ref:a,children:t.options.map((n=>e.jsx(f,{value:n.value,label:n.name,isSelected:t.value===n.value,children:n.name},n.value)))})]})]})}function ce({field:t}){const{value:n,name:a}=t;return e.jsx("input",{type:"hidden",name:a,value:n})}function ue(e){const t=c.useRef(!1),n=c.useRef(!1);return{formRefCallback:c.useCallback((a=>{a&&!t.current&&document&&(t.current=!0,a.submit=async()=>{if(!1===n.current){n.current=!0;const t=await async function(){const e=await fetch("/api/v2/help_center/sessions.json"),{current_session:t}=await e.json();return t.csrf_token}(),r=document.createElement("input");r.type="hidden",r.name="authenticity_token",r.value=t,a.appendChild(r);const i=e.filter((e=>"partialcreditcard"===e.type));for(const e of i){const t=a.querySelector(`input[name="${e.name}"]`);t&&t instanceof HTMLInputElement&&4===t.value.length&&(t.value=`XXXXXXXXX${t.value}`)}HTMLFormElement.prototype.submit.call(a)}})}),[e]),handleSubmit:e=>{e.preventDefault(),e.target.submit()}}}const he=2048,pe="tf_",me=["true","false"],fe=["pre","strong","b","p","blockquote","ul","ol","li","h2","h3","h4","i","em","br"];function ge(e,t){if(!Number.isNaN(Number(e))){const n=`request[custom_fields][${e}]`;return t.ticketFields.find((e=>e.name===n))}switch(e){case"anonymous_requester_email":return t.emailField;case"due_at":return t.dueDateField;case"collaborators":return t.ccField;case"organization_id":return t.organizationField;default:return t.ticketFields.find((t=>t.name===`request[${e}]`))}}function xe({ticketFields:e,ccField:t,dueDateField:n,emailField:a,organizationField:r}){return c.useMemo((()=>function(e){if("undefined"==typeof window)return e;const{href:t}=location,n=new URL(t).searchParams,a={...e,ticketFields:[...e.ticketFields]};if(t.length>he)return e;if(n.get("parent_id"))return e;for(const[e,t]of n){if(!e.startsWith(pe))continue;const n=ge(e.substring(pe.length),a);if(!n)continue;const r=v.sanitize(t,{ALLOWED_TAGS:fe});switch(n.type){case"partialcreditcard":continue;case"multiselect":n.value=r.split(",").filter((e=>n.options.some((t=>t.value===e))));break;case"checkbox":me.includes(r)&&(n.value="true"===r?"on":"false"===r?"off":"");break;default:n.value=r}}return a}({ticketFields:e,ccField:t,dueDateField:n,emailField:a,organizationField:r})),[e,t,n,a,r])}const je=l.div`
  flex: 1;
`;function ve({file:t,onRemove:n}){const{t:a}=d(),r=e=>{"Enter"!==e.code&&"Space"!==e.code&&"Delete"!==e.code&&"Backspace"!==e.code||(e.preventDefault(),n())},i="pending"===t.status?t.file_name:t.value.file_name,s=a("new-request-form.attachments.stop-upload","Stop upload"),l=a("new-request-form.attachments.remove-file","Remove file");return e.jsx(b.Item,{children:e.jsx(y,{type:"generic",title:i,onKeyDown:e=>{"Delete"!==e.code&&"Backspace"!==e.code||(e.preventDefault(),n())},children:"pending"===t.status?e.jsxs(e.Fragment,{children:[e.jsx(je,{children:i}),e.jsx(w,{content:s,children:e.jsx(y.Close,{"aria-label":s,onClick:()=>{n()},onKeyDown:r})}),e.jsx(C,{value:t.progress,"aria-label":a("new-request-form.attachments.uploading","Uploading {{fileName}}",{fileName:i})})]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsx(_,{isExternal:!0,href:t.value.url,target:"_blank",children:i})}),e.jsx(w,{content:l,children:e.jsx(y.Delete,{"aria-label":l,onClick:()=>{n()},onKeyDown:r})}),e.jsx(C,{value:100,"aria-hidden":"true"})]})})})}async function be(){const e=await fetch("/api/v2/users/me.json"),{user:{authenticity_token:t}}=await e.json();return t}function ye({field:a}){const{label:r,error:l,name:o,attachments:u}=a,{files:h,addPendingFile:p,setPendingFileProgress:m,setUploaded:f,removePendingFile:g,removeUploadedFile:x}=function(e){const[t,n]=c.useState(e);return{files:t,addPendingFile:c.useCallback(((e,t,a)=>{n((n=>[...n,{status:"pending",id:e,file_name:t,progress:0,xhr:a}]))}),[]),setPendingFileProgress:c.useCallback(((e,t)=>{n((n=>n.map((n=>"pending"===n.status&&n.id===e?{...n,progress:t}:n))))}),[]),removePendingFile:c.useCallback((e=>{n((t=>t.filter((t=>"pending"!==t.status||t.id!==e))))}),[]),removeUploadedFile:c.useCallback((e=>{n((t=>t.filter((t=>"uploaded"!==t.status||t.value.id!==e))))}),[]),setUploaded:c.useCallback(((e,t)=>{n((n=>n.map((n=>"pending"===n.status&&n.id===e?{status:"uploaded",value:t}:n))))}),[])}}(u.map((e=>({status:"uploaded",value:e})))??[]),{addToast:j}=q(),{t:v}=d(),b=c.useCallback((t=>{j((({close:n})=>e.jsxs(k,{type:"error",children:[e.jsx(S,{children:v("new-request-form.attachments.upload-error-title","Upload error")}),v("new-request-form.attachments.upload-error-description","There was an error uploading {{fileName}}. Try again or upload another file.",{fileName:t}),e.jsx(F,{"aria-label":v("new-request-form.close-label","Close"),onClick:n})]})))}),[j,v]),y=c.useCallback((async e=>{const t=await be();for(const n of e){const e=new XMLHttpRequest,a=new URL(`${window.location.origin}/api/v2/uploads.json`);if(a.searchParams.append("filename",n.name),e.open("POST",a),n.type)e.setRequestHeader("Content-Type",n.type);else{const t=R.getType(n.name);e.setRequestHeader("Content-Type",t||"application/octet-stream")}e.setRequestHeader("X-CSRF-Token",t),e.responseType="json";const r=crypto.randomUUID();p(r,n.name,e),e.upload.addEventListener("progress",(({loaded:e,total:t})=>{const n=Math.round(e/t*100);n<=90&&m(r,n)})),e.addEventListener("load",(()=>{if(e.status>=200&&e.status<300){const{upload:{attachment:{file_name:t,content_url:n},token:a}}=e.response;f(r,{id:a,file_name:t,url:n})}else b(n.name),g(r)})),e.addEventListener("error",(()=>{b(n.name),g(r)})),e.send(n)}}),[p,g,m,f,b]),{getRootProps:w,getInputProps:C,isDragActive:_}=P({onDrop:y});return e.jsxs(t,{children:[e.jsx(n,{children:r}),l&&e.jsx(s,{validation:"error",children:l}),e.jsxs(T,{...w(),isDragging:_,children:[_?e.jsx("span",{children:v("new-request-form.attachments.drop-files-label","Drop files here")}):e.jsx("span",{children:v("new-request-form.attachments.choose-file-label","Choose a file or drag and drop here")}),e.jsx(i,{...C()})]}),h.map((t=>e.jsx(ve,{file:t,onRemove:()=>{(async e=>{if("pending"===e.status)e.xhr.abort(),g(e.id);else{const t=await be(),n=e.value.id;x(e.value.id),await fetch(`/api/v2/uploads/${n}.json`,{method:"DELETE",headers:{"X-CSRF-Token":t}})}})(t)}},"pending"===t.status?t.id:t.value.id))),h.map((t=>"uploaded"===t.status&&e.jsx("input",{type:"hidden",name:o,value:JSON.stringify(t.value)},t.value.id)))]})}function we(e,t){return t.filter((t=>t.child_fields.some((t=>t.id===e))))}function Ce(e,t,n){return e.filter((e=>{const a=n.find((t=>t.id===e.parent_field_id));if(!a)return!1;const r=we(a.id,t);return a.value===e.value&&(0===r.length||Ce(r,t,n).length>0)}))}function _e(e,t){return 0===t.length?e:e.reduce(((n,a)=>{const r=we(a.id,t);if(0===r.length)return[...n,a];const i=Ce(r,t,e);return i.length>0?[...n,{...a,required:i.some((e=>e.child_fields.some((e=>e.id==a.id&&e.is_required))))}]:n}),[])}function qe({field:l,locale:o,valueFormat:d,onChange:u}){const{label:h,error:p,value:m,name:f,required:g,description:x}=l,[j,v]=c.useState(m?new Date(m):void 0),b=e=>{if(void 0===e)return"";const t=e.toISOString();return"dateTime"===d?t:t.split("T")[0]};return e.jsxs(t,{children:[e.jsxs(n,{children:[h,g&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),x&&e.jsx(r,{dangerouslySetInnerHTML:{__html:x}}),e.jsx(I,{value:j,onChange:e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0));v(t);const n=b(t);void 0!==n&&u(n)},locale:o,children:e.jsx(i,{required:g,lang:o,onChange:e=>{""===e.target.value&&(v(void 0),u(""))},validation:p?"error":void 0})}),p&&e.jsx(s,{validation:"error",children:p}),e.jsx("input",{type:"hidden",name:f,value:b(j)})]})}const ke=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,Se=l(L)`
  padding: ${e=>`${e.theme.space.xxs} ${e.theme.space.sm}`};

  // Removes white spaces for inline elements
  font-size: 0;

  // Same as height of Tag size="large" + base space (4px)
  // to give some vertical space between tags
  --line-height: ${e=>8*e.theme.space.base+e.theme.space.base}px;
  line-height: var(--line-height);
`,Fe=l.span`
  display: inline-block;
  margin-right: ${e=>e.theme.space.sm};
`,Re=l($)`
  ${e=>D({theme:e.theme,shadowWidth:"sm",selector:"&:focus"})}
`,Pe=l.div`
  display: inline-block;
  position: relative;
`,Te=l(L)`
  display: inline-block;
  min-width: 200px;
  opacity: 0;
  user-select: none;
  height: var(--line-height);
  line-height: var(--line-height);
`,Ie=l(i)`
  position: absolute;
  top: 0;
  left: 0;
  height: var(--line-height);
  line-height: var(--line-height);
`;function Ee({field:i}){const{label:l,value:o,name:u,error:h,description:p}=i,{t:m}=d(),f=o?o.split(",").map((e=>e.trim())):[],[g,x]=c.useState(f),[j,v]=c.useState(""),b=c.useRef(null),y=c.useRef(null),{getContainerProps:C,getGridProps:_,getGridRowProps:q,getGridCellProps:k,getTagCloseProps:S,getInputProps:F,getAnnouncementProps:R,announcement:P}=function({tags:e,onTagsChange:t,inputValue:n,onInputValueChange:a,inputRef:r,gridRowRef:i,i18n:s}){const[l,o]=c.useState(0),[d,u]=c.useState(""),h=c.useCallback(((e,t)=>{o(t)}),[o]),{getGridProps:p,getGridCellProps:m}=E({matrix:[e],rowIndex:0,colIndex:l,onChange:h}),f=t=>e.includes(t),g=n=>{t([...e,n]),u(s.addedTag(n))},x=n=>{const a=e[n];t(e.filter(((e,t)=>t!==n))),u(s.removedTag(a)),o(0),setTimeout((()=>{const e=i.current?.querySelector('[tabindex="0"]');e?.focus()}),100)},j=e=>{e.target===e.currentTarget&&r.current?.focus()},v=()=>{o(0)},b=e=>{const t=e.target.value;!t||"Space"!==e.code&&"Enter"!==e.code&&"Comma"!==e.code&&"Tab"!==e.code||(e.preventDefault(),f(t)||g(t),a(""))},y=e=>{const t=e.target.value,[n,r]=[t.slice(0,-1),t.slice(-1)];" "===r||","===r?(n.length>0&&!f(n)&&g(n),a("")):a(t)},w=n=>{n.preventDefault();const a=n.clipboardData.getData("text"),r=new Set(a.split(/[\s,;]+/).filter((t=>!e.includes(t))));t([...e,...r]),u(s.addedTags([...r]))},C=e=>t=>{"Backspace"===t.code&&(t.preventDefault(),x(e))},_=e=>()=>{x(e)};return{getContainerProps:()=>({onClick:j,onBlur:v,tabIndex:-1}),getGridProps:p,getGridRowProps:()=>({role:"row"}),getGridCellProps:e=>m({rowIndex:0,colIndex:e,onKeyDown:C(e)}),getTagCloseProps:e=>({onClick:_(e)}),getInputProps:()=>({value:n,onChange:y,onKeyDown:b,onPaste:w}),announcement:d,getAnnouncementProps:()=>({"aria-live":"polite","aria-relevant":"text"})}}({tags:g,onTagsChange:x,inputValue:j,onInputValueChange:v,inputRef:b,gridRowRef:y,i18n:{addedTag:e=>m("new-request-form.cc-field.email-added","{{email}} has been added",{email:e}),removedTag:e=>m("new-request-form.cc-field.email-removed","{{email}} has been removed",{email:e}),addedTags:e=>m("new-request-form.cc-field.emails-added","{{emails}} have been added",{emails:e})}}),T=(t,n,a)=>e.jsxs(Re,{size:"large","aria-label":m("new-request-form.cc-field.email-label","{{email}} - Press Backspace to remove",{email:a}),hue:n?void 0:"red",children:[!n&&e.jsx($.Avatar,{children:e.jsx(G,{})}),e.jsx("span",{children:a}),e.jsx($.Close,{...S(t)})]});return e.jsxs(t,{children:[e.jsx(n,{children:l}),p&&e.jsx(r,{children:p}),e.jsxs(Se,{...C(),children:[g.length>0&&e.jsx("span",{..._({"aria-label":m("new-request-form.cc-field.container-label","Selected CC emails")}),children:e.jsx("span",{ref:y,...q(),children:g.map(((t,n)=>{const a=ke.test(t);return a?e.jsx(Fe,{...k(n),children:T(n,a,t)},n):e.jsx(w,{content:m("new-request-form.cc-field.invalid-email","Invalid email address"),children:e.jsx(Fe,{...k(n),children:T(n,a,t)})},n)}))})}),e.jsxs(Pe,{children:[e.jsx(Te,{isBare:!0,"aria-hidden":"true",tabIndex:-1,children:j}),e.jsx(Ie,{ref:b,isBare:!0,...F()})]})]}),h&&e.jsx(s,{validation:"error",children:h}),g.map((t=>e.jsx("input",{type:"hidden",name:u,value:t},t))),e.jsx(a,{hidden:!0,...R(),children:P})]})}const De=l(a)`
  margin-left: ${e=>e.theme.space.xxs};
  font-weight: ${e=>e.theme.fontWeights.medium};
`;function Le({field:i,onChange:l}){const{t:o}=d(),{label:c,error:u,value:h,name:p,required:m,description:f}=i,g=function(e){return e?e.replaceAll("X",""):""}(h);return e.jsxs(t,{children:[e.jsxs(n,{children:[c,m&&e.jsx(a,{"aria-hidden":"true",children:"*"}),e.jsx(De,{children:o("new-request-form.credit-card-digits-hint","(Last 4 digits)")})]}),f&&e.jsx(r,{dangerouslySetInnerHTML:{__html:f}}),e.jsx(V,{start:e.jsx(M,{}),name:p,type:"text",value:g,onChange:e=>l(e.target.value),validation:u?"error":void 0,required:m,maxLength:4,placeholder:"XXXX"}),u&&e.jsx(s,{validation:"error",children:u})]})}function $e({field:t,onChange:n}){const{label:r,options:i,error:s,value:l,name:o,required:d,description:x}=t,{currentGroup:v,isGroupIdentifier:b,setCurrentGroupByIdentifier:y}=se({options:i,hasEmptyOption:!0}),w=l??"",[C,_]=c.useState(!1),q=c.useRef(null);c.useEffect((()=>{if(q.current&&d){const e=q.current.querySelector("[role=combobox]");e?.setAttribute("aria-required","true")}}),[q,d]);return e.jsxs(u,{children:[e.jsxs(h,{children:[r,d&&e.jsx(a,{"aria-hidden":"true",children:"*"})]}),x&&e.jsx(p,{dangerouslySetInnerHTML:{__html:x}}),e.jsxs(m,{ref:q,inputProps:{required:d,name:o},isEditable:!1,validation:s?"error":void 0,onChange:e=>{"string"==typeof e.selectionValue&&b(e.selectionValue)?y(e.selectionValue):("string"==typeof e.selectionValue&&n(e.selectionValue),void 0!==e.isExpanded&&_(e.isExpanded))},selectionValue:w,inputValue:w,renderValue:({selection:t})=>t?.label??e.jsx(Y,{}),isExpanded:C,children:["SubGroup"===v.type&&e.jsx(f,{...v.backOption}),"SubGroup"===v.type?e.jsx(j,{"aria-label":v.name,children:v.options.map((t=>e.jsx(f,{...t,children:t.menuLabel??t.label},t.value)))}):v.options.map((t=>""===t.value?e.jsx(f,{...t,children:e.jsx(Y,{})},t.value):e.jsx(f,{...t},t.value)))]}),s&&e.jsx(g,{validation:"error",children:s})]})}const Ge=A`
  from {
    grid-template-rows: 0fr;
  }
  to {
    grid-template-rows: 1fr;
  }
`,Ve=l.div`
  display: grid;
  animation: ${Ge} 200ms forwards;
`,Me=l.div`
  overflow: hidden;
`,Ae=l.ul`
  list-style: none;
  padding: 0;
  margin: 0;
`,Xe=l.li`
  margin: ${e=>e.theme.space.sm} 0;
`;function ze({query:t,locale:n}){const a=function(e,t){const[n,a]=c.useState(e);return c.useEffect((()=>{const n=setTimeout((()=>a(e)),t);return()=>{clearTimeout(n)}}),[e,t]),n}(t,500),[r,i]=c.useState([]),s=c.useRef({}),{t:l}=d();return c.useEffect((()=>{const e=a?.trim().toLocaleLowerCase();if(!e||!function(e){const t=e.charCodeAt(0);return t>=19968&&t<=195103?e.length>=2:e.length>=3}(e))return void i([]);const t=new URL(`${window.location.origin}/api/v2/help_center/deflection/suggestions.json`);t.searchParams.append("locale",n),t.searchParams.append("query",e);const r=s.current[t.toString()];r?i(r):fetch(t).then((e=>e.json())).then((({results:e})=>{s.current[t.toString()]=e,i(e)}))}),[a,n]),r.length>0?e.jsx(Ve,{"data-test-id":"suggested-articles",children:e.jsxs(Me,{children:[e.jsx("h2",{children:l("new-request-form.suggested-articles","Suggested articles")}),e.jsx(Ae,{children:r.map((t=>e.jsx(Xe,{children:e.jsx(_,{href:t.html_url,children:t.name})},t.html_url)))})]})}):null}const He=l(X)`
  margin: ${e=>e.theme.space.md} 0;
`,Ue=l.form`
  display: flex;
  flex-direction: column;
  gap: ${e=>e.theme.space.md};
`,Be=l.div`
  margin-top: ${e=>e.theme.space.md};
`;function Oe({requestForm:t,wysiwyg:n,newRequestPath:a,parentId:r,parentIdPath:i,locale:s,baseLocale:l,hasAtMentions:o,userRole:u,brandId:h,settings:p}){z(l);const{ticket_fields:m,action:f,http_method:g,accept_charset:x,errors:j,parent_id_field:v,ticket_form_field:b,email_field:y,cc_field:w,organization_field:C,due_date_field:q,end_user_conditions:k,attachments_field:S,inline_attachments_fields:F,description_mimetype_field:R}=t,{ticketFields:P,emailField:T,ccField:I,organizationField:E,dueDateField:D}=xe({ticketFields:m,emailField:y,ccField:w,organizationField:C,dueDateField:q}),[L,$]=c.useState(P),[G,V]=c.useState(E),[M,A]=c.useState(D),X=_e(L,k),{formRefCallback:W,handleSubmit:J}=ue(L),{t:Z}=d();function Y(e,t){$(L.map((n=>n.name===e.name?{...n,value:t}:n)))}return e.jsxs(H,{theme:U(p),children:[r&&e.jsx(He,{children:e.jsxs(_,{href:i,children:["Follow up to request ",r]})}),e.jsx(He,{"aria-hidden":"true",children:Z("new-request-form.required-fields-info","Fields marked with an asterisk (*) are required.")}),e.jsxs(Ue,{ref:W,action:f,method:g,acceptCharset:x,noValidate:!0,onSubmit:J,children:[j&&e.jsx(B,{type:"error",children:j}),v&&e.jsx(ce,{field:v}),b.options.length>0&&e.jsx(de,{field:b,newRequestPath:a}),T&&e.jsx(K,{field:T},T.name),I&&e.jsx(Ee,{field:I}),G&&e.jsx(ee,{field:G,onChange:e=>{!function(e){null!==G&&V({...G,value:e})}(e)}},G.name),X.map((t=>{switch(t.type){case"subject":return e.jsxs(e.Fragment,{children:[e.jsx(K,{field:t,onChange:e=>Y(t,e)},t.name),e.jsx(ze,{query:t.value,locale:s})]});case"text":case"integer":case"decimal":case"regexp":return e.jsx(K,{field:t,onChange:e=>Y(t,e)},t.name);case"partialcreditcard":return e.jsx(Le,{field:t,onChange:e=>Y(t,e)});case"description":return e.jsxs(e.Fragment,{children:[e.jsx(Q,{field:t,hasWysiwyg:n,baseLocale:l,hasAtMentions:o,userRole:u,brandId:h,onChange:e=>Y(t,e)},t.name),e.jsx("input",{type:"hidden",name:R.name,value:n?"text/html":"text/plain"})]});case"textarea":return e.jsx(Q,{field:t,hasWysiwyg:!1,baseLocale:l,hasAtMentions:o,userRole:u,brandId:h,onChange:e=>Y(t,e)},t.name);case"priority":case"basic_priority":case"tickettype":return e.jsxs(e.Fragment,{children:[e.jsx(ee,{field:t,onChange:e=>Y(t,e)},t.name),"task"===t.value&&e.jsx(qe,{field:M,locale:l,valueFormat:"dateTime",onChange:e=>{!function(e){null!==M&&A({...M,value:e})}(e)}})]});case"checkbox":return e.jsx(te,{field:t,onChange:e=>Y(t,e)});case"date":return e.jsx(qe,{field:t,locale:l,valueFormat:"date",onChange:e=>Y(t,e)});case"multiselect":return e.jsx(le,{field:t});case"tagger":return e.jsx($e,{field:t,onChange:e=>Y(t,e)},t.name);default:return e.jsx(e.Fragment,{})}})),S&&e.jsx(O,{zIndex:2147483647,children:e.jsx(ye,{field:S})}),F.map((({type:t,name:n,value:a},r)=>e.jsx("input",{type:t,name:n,value:a},r))),e.jsx(Be,{children:(0===b.options.length||b.value)&&e.jsx(N,{isPrimary:!0,type:"submit",children:Z("new-request-form.submit","Submit")})})]})]})}function Ne(t,n,a){if("NewRequestForm"!==t)throw new Error(`Unknown component: ${t}`);W.hydrate(e.jsx(Oe,{...n}),a)}export{Oe as NewRequestForm,Ne as hydrateComponent};
